/*****************************************************************************
 * Copyright (c) 2019, Nations Technologies Inc.
 *
 * All rights reserved.
 * ****************************************************************************
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * - Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the disclaimer below.
 *
 * Nations' name may not be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * DISCLAIMER: THIS SOFTWARE IS PROVIDED BY NATIONS "AS IS" AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
 * DISCLAIMED. IN NO EVENT SHALL NATIONS BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
 * OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * ****************************************************************************/

/**
 * @file xfmc_psram.h
 * @author Nations
 * @version v1.0.1
 *
 * @copyright Copyright (c) 2019, Nations Technologies Inc. All rights reserved.
 */
#ifndef __XFMC_PSRAM_H__
#define __XFMC_PSRAM_H__

#include "n32g4fr.h"

#define Bank1_SRAM1_ADDR ((uint32_t)0x60000000) // 0x60000000~63FFFFFF
#define Bank1_SRAM2_ADDR ((uint32_t)0x64000000) // 0x64000000~67FFFFFF
#define Bank1_SRAM3_ADDR ((uint32_t)0x68000000)
#define BUFFER_SIZE      0x400
#define WRITE_READ_ADDR  0x00
#define XFMC_REMAP       0x00 // 00,default; 0x01 remap1; 0x11 remap2

#define TEST_SRAM_NUM    1

/*address signal*/
#define XFMC_A0_GPIO_PORT GPIOF
#define XFMC_A0_GPIO_CLK  RCC_APB2_PERIPH_GPIOF
#define XFMC_A0_GPIO_PIN  GPIO_PIN_0

#define XFMC_A1_GPIO_PORT GPIOF
#define XFMC_A1_GPIO_CLK  RCC_APB2_PERIPH_GPIOF
#define XFMC_A1_GPIO_PIN  GPIO_PIN_1

#define XFMC_A2_GPIO_PORT GPIOF
#define XFMC_A2_GPIO_CLK  RCC_APB2_PERIPH_GPIOF
#define XFMC_A2_GPIO_PIN  GPIO_PIN_2

#define XFMC_A3_GPIO_PORT GPIOF
#define XFMC_A3_GPIO_CLK  RCC_APB2_PERIPH_GPIOF
#define XFMC_A3_GPIO_PIN  GPIO_PIN_3

#define XFMC_A4_GPIO_PORT GPIOF
#define XFMC_A4_GPIO_CLK  RCC_APB2_PERIPH_GPIOF
#define XFMC_A4_GPIO_PIN  GPIO_PIN_4

#define XFMC_A5_GPIO_PORT GPIOF
#define XFMC_A5_GPIO_CLK  RCC_APB2_PERIPH_GPIOF
#define XFMC_A5_GPIO_PIN  GPIO_PIN_5

#define XFMC_A6_GPIO_PORT GPIOF
#define XFMC_A6_GPIO_CLK  RCC_APB2_PERIPH_GPIOF
#define XFMC_A6_GPIO_PIN  GPIO_PIN_12

#define XFMC_A7_GPIO_PORT GPIOF
#define XFMC_A7_GPIO_CLK  RCC_APB2_PERIPH_GPIOF
#define XFMC_A7_GPIO_PIN  GPIO_PIN_13

#define XFMC_A8_GPIO_PORT GPIOF
#define XFMC_A8_GPIO_CLK  RCC_APB2_PERIPH_GPIOF
#define XFMC_A8_GPIO_PIN  GPIO_PIN_14

#define XFMC_A9_GPIO_PORT GPIOF
#define XFMC_A9_GPIO_CLK  RCC_APB2_PERIPH_GPIOF
#define XFMC_A9_GPIO_PIN  GPIO_PIN_15

#define XFMC_A10_GPIO_PORT GPIOG
#define XFMC_A10_GPIO_CLK  RCC_APB2_PERIPH_GPIOG
#define XFMC_A10_GPIO_PIN  GPIO_PIN_0

#define XFMC_A11_GPIO_PORT GPIOG
#define XFMC_A11_GPIO_CLK  RCC_APB2_PERIPH_GPIOG
#define XFMC_A11_GPIO_PIN  GPIO_PIN_1

#define XFMC_A12_GPIO_PORT GPIOG
#define XFMC_A12_GPIO_CLK  RCC_APB2_PERIPH_GPIOG
#define XFMC_A12_GPIO_PIN  GPIO_PIN_2

#define XFMC_A13_GPIO_PORT GPIOG
#define XFMC_A13_GPIO_CLK  RCC_APB2_PERIPH_GPIOG
#define XFMC_A13_GPIO_PIN  GPIO_PIN_3

#define XFMC_A14_GPIO_PORT GPIOG
#define XFMC_A14_GPIO_CLK  RCC_APB2_PERIPH_GPIOG
#define XFMC_A14_GPIO_PIN  GPIO_PIN_4

#define XFMC_A15_GPIO_PORT GPIOG
#define XFMC_A15_GPIO_CLK  RCC_APB2_PERIPH_GPIOG
#define XFMC_A15_GPIO_PIN  GPIO_PIN_5

#if (XFMC_REMAP == 0x00 || XFMC_REMAP == 0x01)

#define XFMC_A16_GPIO_PORT GPIOD
#define XFMC_A16_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_A16_GPIO_PIN  GPIO_PIN_11

#define XFMC_A17_GPIO_PORT GPIOD
#define XFMC_A17_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_A17_GPIO_PIN  GPIO_PIN_12

#elif (XFMC_REMAP == 0x11)

#define XFMC_A16_GPIO_PORT GPIOC
#define XFMC_A16_GPIO_CLK  RCC_APB2_PERIPH_GPIOC
#define XFMC_A16_GPIO_PIN  GPIO_PIN_6

#define XFMC_A17_GPIO_PORT GPIOC
#define XFMC_A17_GPIO_CLK  RCC_APB2_PERIPH_GPIOC
#define XFMC_A17_GPIO_PIN  GPIO_PIN_7

#endif

#define XFMC_A18_GPIO_PORT GPIOD
#define XFMC_A18_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_A18_GPIO_PIN  GPIO_PIN_13

#define XFMC_A19_GPIO_PORT GPIOE
#define XFMC_A19_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_A19_GPIO_PIN  GPIO_PIN_3

#define XFMC_A20_GPIO_PORT GPIOE
#define XFMC_A20_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_A20_GPIO_PIN  GPIO_PIN_4

#define XFMC_A21_GPIO_PORT GPIOE
#define XFMC_A21_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_A21_GPIO_PIN  GPIO_PIN_5

#define XFMC_A22_GPIO_PORT GPIOE
#define XFMC_A22_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_A22_GPIO_PIN  GPIO_PIN_6

#define XFMC_A23_GPIO_PORT GPIOE
#define XFMC_A23_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_A23_GPIO_PIN  GPIO_PIN_2

/*data signal*/
#define XFMC_D0_GPIO_PORT GPIOD
#define XFMC_D0_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_D0_GPIO_PIN  GPIO_PIN_14

#define XFMC_D1_GPIO_PORT GPIOD
#define XFMC_D1_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_D1_GPIO_PIN  GPIO_PIN_15

#define XFMC_D2_GPIO_PORT GPIOD
#define XFMC_D2_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_D2_GPIO_PIN  GPIO_PIN_0

#define XFMC_D3_GPIO_PORT GPIOD
#define XFMC_D3_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_D3_GPIO_PIN  GPIO_PIN_1

#define XFMC_D4_GPIO_PORT GPIOE
#define XFMC_D4_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_D4_GPIO_PIN  GPIO_PIN_7

#define XFMC_D5_GPIO_PORT GPIOE
#define XFMC_D5_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_D5_GPIO_PIN  GPIO_PIN_8

#define XFMC_D6_GPIO_PORT GPIOE
#define XFMC_D6_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_D6_GPIO_PIN  GPIO_PIN_9

#define XFMC_D7_GPIO_PORT GPIOE
#define XFMC_D7_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_D7_GPIO_PIN  GPIO_PIN_10

#define XFMC_D8_GPIO_PORT GPIOE
#define XFMC_D8_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_D8_GPIO_PIN  GPIO_PIN_11

#define XFMC_D9_GPIO_PORT GPIOE
#define XFMC_D9_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_D9_GPIO_PIN  GPIO_PIN_12

#define XFMC_D10_GPIO_PORT GPIOE
#define XFMC_D10_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_D10_GPIO_PIN  GPIO_PIN_13

#if (XFMC_REMAP == 0)

#define XFMC_D11_GPIO_PORT GPIOE
#define XFMC_D11_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_D11_GPIO_PIN  GPIO_PIN_14

#define XFMC_D12_GPIO_PORT GPIOE
#define XFMC_D12_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_D12_GPIO_PIN  GPIO_PIN_15

#elif ((XFMC_REMAP == 0x01) || (XFMC_REMAP == 0x11))

#define XFMC_D11_GPIO_PORT GPIOB
#define XFMC_D11_GPIO_CLK  RCC_APB2_PERIPH_GPIOB
#define XFMC_D11_GPIO_PIN  GPIO_PIN_10

#define XFMC_D12_GPIO_PORT GPIOB
#define XFMC_D12_GPIO_CLK  RCC_APB2_PERIPH_GPIOB
#define XFMC_D12_GPIO_PIN  GPIO_PIN_11

#endif

#define XFMC_D13_GPIO_PORT GPIOD
#define XFMC_D13_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_D13_GPIO_PIN  GPIO_PIN_8

#define XFMC_D14_GPIO_PORT GPIOD
#define XFMC_D14_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_D14_GPIO_PIN  GPIO_PIN_9

#define XFMC_D15_GPIO_PORT GPIOD
#define XFMC_D15_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_D15_GPIO_PIN  GPIO_PIN_10

/*control signal*/
#if (XFMC_REMAP == 0x00 || XFMC_REMAP == 0x01)
/*CS:chip select*/
/*NE1:0x60000000~0x63FFFFFF*/
#define XFMC_CS_GPIO_PORT GPIOD
#define XFMC_CS_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_CS_GPIO_PIN  GPIO_PIN_7

/*NE2:0x64000000~0x67FFFFFF*/
#define XFMC_CS1_GPIO_PORT GPIOG
#define XFMC_CS1_GPIO_CLK  RCC_APB2_PERIPH_GPIOG
#define XFMC_CS1_GPIO_PIN  GPIO_PIN_9

/*WE:write enable*/
#define XFMC_WE_GPIO_PORT GPIOD
#define XFMC_WE_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_WE_GPIO_PIN  GPIO_PIN_5

/*OE:read enable*/
#define XFMC_OE_GPIO_PORT GPIOD
#define XFMC_OE_GPIO_CLK  RCC_APB2_PERIPH_GPIOD
#define XFMC_OE_GPIO_PIN  GPIO_PIN_4

#elif (XFMC_REMAP == 0x11)

/*CS:chip select*/
/*NE1:0x60000000~0x63FFFFFF*/
#define XFMC_CS_GPIO_PORT  GPIOB
#define XFMC_CS_GPIO_CLK   RCC_APB2_PERIPH_GPIOB
#define XFMC_CS_GPIO_PIN   GPIO_PIN_9

/*NE2:0x60000000~0x63FFFFFF*/
#define XFMC_CS1_GPIO_PORT GPIOB
#define XFMC_CS1_GPIO_CLK  RCC_APB2_PERIPH_GPIOB
#define XFMC_CS1_GPIO_PIN  GPIO_PIN_6

/*WE:write enable*/
#define XFMC_WE_GPIO_PORT  GPIOA
#define XFMC_WE_GPIO_CLK   RCC_APB2_PERIPH_GPIOA
#define XFMC_WE_GPIO_PIN   GPIO_PIN_10

/*OE:read enable*/
#define XFMC_OE_GPIO_PORT  GPIOC
#define XFMC_OE_GPIO_CLK   RCC_APB2_PERIPH_GPIOC
#define XFMC_OE_GPIO_PIN   GPIO_PIN_9

#endif

/*UB*/
#define XFMC_UDQM_GPIO_PORT GPIOE
#define XFMC_UDQM_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_UDQM_GPIO_PIN  GPIO_PIN_1

/*LB*/
#define XFMC_LDQM_GPIO_PORT GPIOE
#define XFMC_LDQM_GPIO_CLK  RCC_APB2_PERIPH_GPIOE
#define XFMC_LDQM_GPIO_PIN  GPIO_PIN_0

void SRAM_Gpio_Config(uint8_t bank_num);
void XFMC_Psram_Init(uint8_t bank_num);
void XFMC_Psram_Read_Buffer(uint16_t* pBuffer, uint8_t bank_index, uint32_t read_addr, uint32_t number);
void XFMC_Psram_Write_Buffer(uint16_t* pBuffer, uint8_t bank_index, uint32_t write_addr, uint32_t number);
void XFMC_Psram_Fill(uint8_t bank_index, uint32_t start_addr, uint32_t number, uint16_t data);

#endif //__XFMC_PSRAM_H__
